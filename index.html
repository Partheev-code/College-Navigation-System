<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horizontal Login Page</title>
    <link rel="stylesheet"  href="index.css">
</head>
<body>
    <div class="login-container">
        <div class="features-section">
            <h3>College Navigation System</h3>
            <ul>
                <li>Interactive Campus Map Navigation</li>
                <li>Faculty Information Access</li>
                <li>Real-time Attendance Tracking</li>
                <li>Easy Appointment Booking</li>
                <li>Campus Updates and Notifications</li>
            </ul>
        </div>
        <div class="login-section">
            <h2>Welcome!</h2>
            <p>Please login to your account</p>
            <div class="role-selection">
                <button class="active">Student</button>
                <button>Faculty</button>
                <button>Admin</button>
            </div>
            <form id="login-form" action="login.php" method="POST">
                <div class="input-container">
                    <input type="hidden" name="role" id="role" value="Student">
                    <input type="text" id="username" name="username" placeholder="Enter username or email" required>
                    <div class="error-message" id="username-error"></div>
                </div>
                <div class="input-container">
                    <div class="password-container">
                        <input type="password" id="password" name="password" placeholder="Enter your password" required>
                        <span class="toggle-password" onclick="togglePassword()">ðŸ˜Œ</span>
                    </div>
                    <div class="error-message" id="password-error"></div>
                </div>
                <div class="error-message" id="general-error"></div>
                <button type="submit" class="login-btn">Login</button>
            </form>
            <div class="skip-section">
                <p class="or-text"><b>or</b></p>
                <div class="action-buttons">
                    <a href="campus_map.html" class="skip-btn" aria-label="Skip login and continue as visitor">Visitor</a>
                    <button class="register-btn" onclick="openRegisterModal()" aria-label="Register for a new account">Register</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal" id="register-modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeRegisterModal()" aria-label="Close registration modal">Ã—</span>
            <h2>Register</h2>
            <form id="register-form" action="register.php" method="POST">
                <div class="input-container">
                    <input type="text" id="register-username" name="username" placeholder="Enter username " required>
                    <div class="error-message" id="register-username-error"></div>
                </div>
                  <div class="input-container">
    <input type="text" id="register-email" name="email" placeholder="Enter email" required>
    <div class="error-message" id="register-email-error"></div>
</div>
                <div class="input-container">
                    <select id="register-role" name="role">
                        <option value="Student">Student</option>
                        <option value="Faculty">Faculty</option>
                    </select>
                    <div class="error-message" id="register-role-error"></div>
                </div>
                <div class="input-container">
                    <div class="password-container">
                        <input type="password" id="register-password" name="password" placeholder="Enter password" required>
                        <span class="toggle-password" onclick="toggleRegisterPassword('register-password')">ðŸ˜Œ</span>
                    </div>
                    <div class="error-message" id="register-password-error"></div>
                </div>
                <div class="input-container">
                    <div class="password-container">
                        <input type="password" id="register-confirm-password" name="confirm-password" placeholder="Confirm password" required>
                        <span class="toggle-password" onclick="toggleRegisterPassword('register-confirm-password')">ðŸ˜Œ</span>
                    </div>
                    <div class="error-message" id="register-confirm-password-error"></div>
                </div>
                <button type="submit" class="register-submit-btn">Register</button>
            </form>
        </div>
    </div>
    <script>
        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const toggleIcon = document.querySelector('.login-section .toggle-password');
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.textContent = 'ðŸ«£';
            } else {
                passwordInput.type = 'password';
                toggleIcon.textContent = 'ðŸ˜Œ';
            }
        }
        function toggleRegisterPassword(inputId) {
            const passwordInput = document.getElementById(inputId);
            const toggleIcon = passwordInput.nextElementSibling;
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.textContent = 'ðŸ«£';
            } else {
                passwordInput.type = 'password';
                toggleIcon.textContent = 'ðŸ˜Œ';
            }
        }
        const roleButtons = document.querySelectorAll('.role-selection button');
        const roleInput = document.getElementById('role');
        roleButtons.forEach(button => {
            button.addEventListener('click', () => {
                roleButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                roleInput.value = button.textContent;
            });
        });
        function openRegisterModal() {
            const modal = document.getElementById('register-modal');
            const roleSelect = document.getElementById('register-role');
            const activeRole = document.querySelector('.role-selection button.active').textContent;
            roleSelect.value = activeRole;
            modal.style.display = 'flex';
            document.getElementById('register-username').focus();
        }
        function closeRegisterModal() {
            const modal = document.getElementById('register-modal');
            modal.style.display = 'none';
            document.getElementById('register-form').reset();
            document.querySelectorAll('.modal-content .error-message').forEach(error => error.style.display = 'none');
            document.querySelectorAll('.modal-content .toggle-password').forEach(icon => {
                icon.textContent = 'ðŸ˜Œ';
                icon.previousElementSibling.type = 'password';
            });
        }
        document.getElementById('register-modal').addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                closeRegisterModal();
            }
        });
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && document.getElementById('register-modal').style.display === 'flex') {
                closeRegisterModal();
            }
        });
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const usernameError = document.getElementById('username-error');
            const passwordError = document.getElementById('password-error');
            const generalError = document.getElementById('general-error');
            usernameError.style.display = 'none';
            passwordError.style.display = 'none';
            generalError.style.display = 'none';
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            if (!username) {
                usernameError.textContent = 'Username is required';
                usernameError.style.display = 'block';
                return;
            }
            if (!password) {
                passwordError.textContent = 'Password is required';
                passwordError.style.display = 'block';
                return;
            }
            const formData = new FormData(e.target);
            try {
                const response = await fetch('login.php', {
                    method: 'POST',
                    body: formData
                });
                const data = await response.json();
                console.log('Login response:', data); // Debug
                if (data.success) {
                    const dashboards = {
                        'Student': 'student_dashboard.html',
                        'Faculty': 'faculty_dashboard.html',
                        'Admin': 'admin_dashboard.html'
                    };
                    const dashboard = dashboards[data.role] || 'index.html';
                    window.location.href = dashboard;
                } else {
                    generalError.textContent = data.message || 'Login failed';
                    generalError.style.display = 'block';
                }
            } catch (error) {
                console.error('Fetch error:', error);
                generalError.textContent = 'Network error. Please try again.';
                generalError.style.display = 'block';
            }
        });
        document.getElementById('register-form').addEventListener('submit', (e) => {
            const username = document.getElementById('register-username').value.trim();
            const password = document.getElementById('register-password').value.trim();
            const confirmPassword = document.getElementById('register-confirm-password').value.trim();
            const role = document.getElementById('register-role').value;
            const usernameError = document.getElementById('register-username-error');
            const passwordError = document.getElementById('register-password-error');
            const confirmPasswordError = document.getElementById('register-confirm-password-error');
            const roleError = document.getElementById('register-role-error');
            usernameError.style.display = 'none';
            passwordError.style.display = 'none';
            confirmPasswordError.style.display = 'none';
            roleError.style.display = 'none';
            let isValid = true;
            if (!username) {
                usernameError.textContent = 'Username is required';
                usernameError.style.display = 'block';
                isValid = false;
            }
            if (!role) {
                roleError.textContent = 'Role is required';
                roleError.style.display = 'block';
                isValid = false;
            }
            if (!password) {
                passwordError.textContent = 'Password is required';
                passwordError.style.display = 'block';
                isValid = false;
            }
            if (password !== confirmPassword) {
                confirmPasswordError.textContent = 'Passwords do not match';
                confirmPasswordError.style.display = 'block';
                isValid = false;
            }
            if (!isValid) e.preventDefault();
        });
    </script>
</body>
</html>